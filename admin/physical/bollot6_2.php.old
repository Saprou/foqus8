<?php
	//ini_set('display_errors',1);
	//ini_set('display_startup_errors');
	//error_reporting(E_ALL);
include 'connect.php'; 
//require('fpdf/fpdf.php');
$doc_root = $_SERVER["DOCUMENT_ROOT"]; 
require_once($doc_root."/../vendor/autoload.php");
class PDF extends FPDF
{
//protected $col = 0; // Current column
// Page header


}

$pdf = new PDF();
$pdf->AddFont('THSarabunNew','','THSarabunNew.php');
$pdf->AddFont('THSarabunNew','B','THSarabunNew_b.php');
$pdf->AddPage();
$pdf->AliasNbPages();
$pdf->SetAutoPageBreak(true,10); 


$lastprintedcol=2;
$width=93;
$height=85;
$TotalAgendas= 4;
$currentline =1 ;
$totallines = ceil($TotalAgendas / 2);
//$pdf->setXY($x,$y);
$siholder = $_REQUEST['siholder'];
$query_EGM = "SELECT * FROM EGM WHERE i_holder = '".$siholder."' ORDER BY ID";
$query_agenda = "select * from AGENDAS  where Agenda_Completed='N' order by ID";
$result1 = sqlsrv_query($conn, $query_EGM);
$result2 = sqlsrv_query($conn, $query_agenda);
while($row2 = sqlsrv_fetch_array($result2, SQLSRV_FETCH_ASSOC)){
	for($i=1; $i<=$TotalAgendas; $i++){	
if (($i %2) !=0){ 
	
$pdf->SetFont('THSarabunNew','',9);	
$pdf->cell( 93  , 27 , iconv( 'UTF-8','cp874' , 'Agenda name'.$row2['Agenda_Name_Thai'] ) ,  1, 1,'L');
$pdf->SetFont('THSarabunNew','B',7);
$pdf->cell( 93  , 4 , iconv( 'UTF-8','cp874' , 'Name sahreholder' ) ,  'LR', 1,'L');
$pdf->SetFont('THSarabunNew','',6);
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , 'จำนวนหุ้นที่ลงคะแนน                                                                                                                                          100 shares' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , 'No. of Shares Attended' ) ,  'LR', 1,'L');
$pdf->SetFont('THSarabunNew','',8);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '    	เห็นด้วย                                                                    BARCODE' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '      Approve                                                                    number barcode' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , '                    ') ,  'LR', 1,'L');
$pdf->SetFont('THSarabunNew','',8);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '    	ไม่เห็นด้วย        BARCODE' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '      Disapprove        number barcode' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , '                    ') ,  'LR', 1,'L');
$pdf->SetFont('THSarabunNew','',8);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '    	งดออกเสียง                                                                     BARCODE' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '      Abstain                                                                     number barcode' ) ,  'LR', 1,'L');
$pdf->SetFont('THSarabunNew','',6);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , 'กรณีที่ผู้ถือหุ้นไม่ลงคะแนนในช่องใด ๆ จะถือว่าเห็นด้วยในวาระนั้น ๆ                                                                                AGENDA' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , 'กรุณาคืนบัตรลงคะแนนทุกครั้งก่อนออกจากห้อง' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 2 , iconv( 'UTF-8','cp874' , '     ' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , '                    ลายมือชื่อ_____________________                                                                                                          #Number' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '                    Signature (Name of shareholder)                                                                                                    Datetime' ) ,  'LR', 1,'L');
$pdf->cell( 93  , 2 , iconv( 'UTF-8','cp874' , '                    ') ,  'LRB', 1,'L');

}
 else{ 
 $Y = 10;
 $X = 85;

$pdf->Ln(-85);
$pdf->cell(93);
$pdf->SetFont('THSarabunNew','',9);		
$pdf->cell( 93  , 27 , iconv( 'UTF-8','cp874' , 'Agenda name'.$row2['Agenda_Name_Thai'] ) ,  1, 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->SetFont('THSarabunNew','B',7);
$pdf->cell( 93  , 4 , iconv( 'UTF-8','cp874' , 'Name sahreholder' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->SetFont('THSarabunNew','',6);
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , 'จำนวนหุ้นที่ลงคะแนน                                                                                                                                          100 shares' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , 'No. of Shares Attended' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->SetFont('THSarabunNew','',8);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '    	เห็นด้วย                                                                    BARCODE' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '      Approve                                                                    number barcode' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , '                    ') ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->SetFont('THSarabunNew','',8);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '    	ไม่เห็นด้วย        BARCODE' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '      Disapprove        number barcode' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , '                    ') ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->SetFont('THSarabunNew','',8);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '    	งดออกเสียง                                                                     BARCODE' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '      Abstain                                                                     number barcode' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->SetFont('THSarabunNew','',6);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , 'กรณีที่ผู้ถือหุ้นไม่ลงคะแนนในช่องใด ๆ จะถือว่าเห็นด้วยในวาระนั้น ๆ                                                                                AGENDA' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , 'กรุณาคืนบัตรลงคะแนนทุกครั้งก่อนออกจากห้อง' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 2 , iconv( 'UTF-8','cp874' , '     ' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 5 , iconv( 'UTF-8','cp874' , '                    ลายมือชื่อ_____________________                                                                                                          #Number' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 3 , iconv( 'UTF-8','cp874' , '                    Signature (Name of shareholder)                                                                                                    Datetime' ) ,  'LR', 1,'L');
$pdf->Ln(0);
$pdf->cell(93);
$pdf->cell( 93  , 2 , iconv( 'UTF-8','cp874' , '                    ') ,  'LRB', 1,'L');
$pdf->Ln(0);
$pdf->setY(95);
$pdf->Ln(0);
}

 }
$pdf->Output();
//for($i=1;$i<=40;$i++)
//    $pdf->Cell(0,10,'Printing line number '.$i,1,1,'L');
}
?>